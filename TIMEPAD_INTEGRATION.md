# Интеграция с TimepadRu

## Обзор

В этом документе описывается интеграция приложения EventParser с сайтом [TimepadRu](https://afisha.timepad.ru/moscow) для парсинга мероприятий.

## Реализованные изменения

1. **Добавлен новый источник данных**
   - URL `https://afisha.timepad.ru/moscow` добавлен в список источников для парсинга в файле `application.properties`

2. **Расширен класс WebsiteEventParser**
   - Добавлена проверка URL на принадлежность к TimepadRu
   - Реализован специализированный метод `parseTimepadRuEventElement` для парсинга мероприятий с TimepadRu
   - Обновлен метод `parseEvents` для использования специализированного метода для TimepadRu

3. **Селекторы для TimepadRu**
   - Для поиска элементов мероприятий: `.event-card, .event-list__item`
   - Для названия мероприятия: `h2.event-card__title, .event-name, .event-list__item-title, a.event-card__link, a.event-list__item-link`
   - Для даты мероприятия: `.event-card__date, .event-list__item-date, .event-date, time, .date`
   - Для места проведения: `.event-card__location, .event-list__item-location, .event-venue, .location, .venue`
   - Для цены: `.event-card__price, .event-list__item-price, .event-price, .price, span:contains(₽), span:contains(руб)`
   - Для организатора: `.event-card__organizer, .event-list__item-organizer, .event-organizer`

## Как это работает

1. Приложение периодически запускает парсинг мероприятий из всех настроенных источников
2. Для каждого источника определяется, какой метод парсинга использовать
3. Для TimepadRu используется специализированный метод `parseTimepadRuEventElement`
4. Метод извлекает информацию о мероприятиях с помощью CSS-селекторов
5. Извлеченная информация преобразуется в объекты `Event` и сохраняется в базе данных

## Тестирование

Для проверки работы парсера TimepadRu:

1. Запустите приложение
2. Дождитесь выполнения запланированного парсинга или запустите его вручную
3. Проверьте логи на наличие сообщений о парсинге TimepadRu
4. Проверьте базу данных на наличие новых мероприятий с источником TimepadRu

## Возможные проблемы и их решения

1. **Не найдены элементы мероприятий**
   - Проверьте, не изменилась ли структура HTML на сайте TimepadRu
   - Обновите CSS-селекторы в методе `parseTimepadRuEventElement`

2. **Ошибки при парсинге дат**
   - Проверьте формат дат на сайте TimepadRu
   - При необходимости обновите метод парсинга дат

3. **Ошибки подключения к сайту**
   - Проверьте доступность сайта TimepadRu
   - Увеличьте значение таймаута в `application.properties`
   - Обновите User-Agent в `application.properties`

## Дальнейшие улучшения

1. Реализовать более точный парсинг дат для TimepadRu
2. Добавить парсинг дополнительной информации о мероприятиях (описание, категории и т.д.)
3. Реализовать парсинг контактной информации организаторов с детальных страниц мероприятий
4. Добавить поддержку пагинации для получения большего количества мероприятий